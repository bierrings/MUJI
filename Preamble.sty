%%% Define this preamble's name %%%
\ProvidesPackage{Preamble}

%%% Contains... %%%

\usepackage{lastpage}                                                   % Sidetal 

\usepackage{listings}
\usepackage{xcolor}
\lstdefinestyle{sharpc}{language=[Sharp]C, frame=lr, rulecolor=\color{blue!80!black}}


% ¤¤ Oversaettelse og tegnsaetning ¤¤ %
\usepackage[utf8]{inputenc}				                            	% Input-indkodning af tegnsæt (UTF8)
\usepackage[english]{babel}				                            	% Dokumentets sprog
\usepackage[T1]{fontenc}				                            	% Output-indkodning af tegnsaet (T1)
\usepackage{ragged2e,anyfontsize}		                               	% Justering af elementer
			
% ¤¤ Figurer og tabeller (floats) ¤¤ %
\usepackage{graphicx} 					                            	% Håndtering af eksterne billeder (JPG, PNG, EPS, PDF)
%\usepackage{eso-pic}						                            % Tilfoej billedekommandoer paa hver side
\usepackage{wrapfig}						                            % Indsaettelse af figurer omsvoebt af tekst. \begin{wrapfigure}{Placering}{Stoerrelse}
\usepackage{multirow}                		                            % Fletning af raekker og kolonner (\multicolumn og \multirow)
\usepackage{multicol}         	                                    	% Muliggør output i spalter
\usepackage{rotating}					                            	% Rotation af tekst med \begin{sideways}...\end{sideways}
\usepackage{colortbl} 					                            	% Farver i tabeller (fx \columncolor og \rowcolor)
\usepackage{xcolor}						                            	% Definer farver med \definecolor. Se mere: http://en.wikibooks.org/wiki/LaTeX/Colors
\usepackage{flafter}					                            	% Soerger for at floats ikke optraeder i teksten foer deres reference
\let\newfloat\relax 					                            	% Justering mellem float-pakken og memoir
\usepackage{float}						                            	% Muliggør eksakt placering af floats, f.eks. \begin{figure}[H]
%\usepackage{subfig}

\graphicspath{{./07.Figurer/}}                                           % Her er alle vores figurer. Så kan man bare referere til dem med filavn.

% Algoritmer %
\usepackage{algorithm}
\usepackage{algpseudocode}

% ¤¤ Matematik mm. ¤¤
\usepackage{amsmath,amssymb,stmaryrd,amsfonts} 		                    % Avancerede matematik-udvidelser
\usepackage{mathtools}						                            % Andre matematik- og tegnudvidelser
\usepackage{textcomp}                 	                               	% Symbol-udvidelser (f.eks. promille-tegn med \textperthousand )

% ¤¤ Referencer og kilder ¤¤ %
\usepackage[danish]{varioref}				                            % Muliggoer bl.a. krydshenvisninger med sidetal (\vref)
\usepackage[
backend=biber,
style=numeric,
sorting=none
]{biblatex}
\usepackage{csquotes}                                                   % Support for references (used with babel/polyglossia)

\usepackage{xr}							                            % Referencer til eksternt dokument med \externaldocument{<NAVN>}
%\usepackage{glossaries}					                            % Terminologi- eller symbolliste (se mere i Daleifs Latex-bog)

% ¤¤ Misc. ¤¤ %
\usepackage{listings}					                            	% Placer kildekode i dokumentet med \begin{lstlisting}...\end{lstlisting}
\usepackage{lipsum}							                            % Dummy text \lipsum[..]
\usepackage[shortlabels]{enumitem}			                            % Muliggoer enkelt konfiguration af lister
\usepackage{pdfpages}					                                % Goer det muligt at inkludere pdf-dokumenter med kommandoen \includepdf[pages={x-y}]{fil.pdf}	
\pdfoptionpdfminorversion=6					                            % Muliggoer inkludering af pdf dokumenter, af version 1.6 og hoejere
\pretolerance=2500 							                            % Justering af afstand mellem ord (hoejt tal, mindre orddeling og mere luft mellem ord)

% Kommentarer og rettelser med \fxnote. Med 'final' i stedet for 'draft' udløser hver note en error i den færdige rapport.
\usepackage[footnote,draft,english,silent,nomargin]{fixme}	

%%%% CUSTOM SETTINGS %%%%

% ¤¤ Marginer ¤¤ %
\setlrmarginsandblock{2.5cm}{2.5cm}{*}	                               	% \setlrmarginsandblock{Indbinding}{Kant}{Ratio}
\setulmarginsandblock{2.5cm}{3.0cm}{*}	                            	% \setulmarginsandblock{Top}{Bund}{Ratio}
\checkandfixthelayout 					                            	% Oversaetter vaerdier til brug for andre pakker

%	¤¤ Afsnitsformatering ¤¤ %
\setlength{\parindent}{0pt}           	                               	% Stoerrelse af indryk
\setlength{\parskip}{6pt}          			                            % Afstand mellem afsnit ved brug af double Enter
\linespread{1,5}							                            % Linie afstand

% ¤¤ Indholdsfortegnelse ¤¤ %
\setsecnumdepth{subsection}		 			                            % Dybden af nummerede overkrifter (part/chapter/section/subsection)
\maxsecnumdepth{subsection}				                            	% Dokumentklassens graense for nummereringsdybde
\settocdepth{subsection} 					                            % Dybden af indholdsfortegnelsen

% ¤¤ Lister ¤¤ %
\setlist{
  topsep=0pt,								                            % Vertikal afstand mellem tekst og listen
  itemsep=-1ex,								                            % Vertikal afstand mellem items
} 

% ¤¤ Visuelle referencer ¤¤ %
\usepackage[colorlinks]{hyperref}			                            % Danner klikbare referencer (hyperlinks) i dokumentet.
\hypersetup{colorlinks = true,				                            % Opsaetning af farvede hyperlinks (interne links, citeringer og URL)
    linkcolor = black,
    citecolor = black,
    urlcolor = black
}

% ¤¤ Opsaetning af figur- og tabeltekst ¤¤ %
\captionnamefont{\small\bfseries\itshape}	                            % Opsaetning af tekstdelen ('Figur' eller 'Tabel')
\captiontitlefont{\small}					                            % Opsaetning af nummerering
\captiondelim{. }							                            % Seperator mellem nummerering og figurtekst
\hangcaption							                            	% Venstrejusterer flere-liniers figurtekst under hinanden
\captionwidth{\linewidth}				                               	% Bredden af figurteksten
\setlength{\belowcaptionskip}{0pt}		                            	% Afstand under figurteksten
		
% ¤¤ Opsaetning af listings ¤¤ %

\definecolor{commentGreen}{RGB}{34,139,24}
\definecolor{stringPurple}{RGB}{208,76,239}

\lstset{language=Matlab,				                            	% Sprog
	basicstyle=\ttfamily\scriptsize,	                            	% Opsaetning af teksten
	keywords={for,if,while,else,elseif,		                            % Noegleord at fremhaeve
			  end,break,return,case,
			  switch,function},
	keywordstyle=\color{blue},				                            % Opsaetning af noegleord
	commentstyle=\color{commentGreen},		                            % Opsaetning af kommentarer
	stringstyle=\color{stringPurple},	                            	% Opsaetning af strenge
	showstringspaces=false,				                            	% Mellemrum i strenge enten vist eller blanke
	numbers=left, numberstyle=\tiny,	                            	% Linjenumre
	extendedchars=true, 				                            	% Tillader specielle karakterer
	columns=flexible,					                            	% Kolonnejustering
	breaklines, breakatwhitespace=true,	                            	% Bryd lange linjer
}

% ¤¤ Navngivning ¤¤ %
\addto\captionsdanish{
	\renewcommand\appendixname{Appendiks}
	\renewcommand\contentsname{Indholdsfortegnelse}	
	\renewcommand\appendixpagename{Appendiks}
	\renewcommand\appendixtocname{Appendiks}
%	\renewcommand\cftchaptername{\chaptername~}				            % Skriver "Kapitel" foran kapitlerne i indholdsfortegnelsen
	\renewcommand\cftappendixname{\appendixname~}			            % Skriver "Appendiks" foran appendiks i indholdsfortegnelsen
}

% ¤¤ Kapiteludssende ¤¤ %
\definecolor{numbercolor}{gray}{0.7}		                            % Definerer en farve til brug til kapiteludseende
\newif\ifchapternonum

\makechapterstyle{jenor}{				                            	% Definerer kapiteludseende frem til ...
  \renewcommand\beforechapskip{0pt}
  \renewcommand\printchaptername{}
  \renewcommand\printchapternum{}
  \renewcommand\printchapternonum{\chapternonumtrue}
  \renewcommand\chaptitlefont{\fontfamily{pbk}\fontseries{db}\fontshape{n}\fontsize{20}{30}\selectfont\raggedleft}
  \renewcommand\chapnumfont{\fontfamily{pbk}\fontseries{m}\fontshape{n}\fontsize{0,5in}{0in}\selectfont\color{numbercolor}}
  \renewcommand\printchaptertitle[1]{%
    \noindent
    \ifchapternonum
        \begin{tabularx}{\textwidth}{X}
        {\let\\\newline\chaptitlefont ##1\par} 
        \end{tabularx}
        \par\vskip-2.5mm\hrule
    \else
        \begin{tabularx}{\textwidth}{Xl}
        {\parbox[b]{\linewidth}{\chaptitlefont ##1}} & \raisebox{-5pt}{\chapnumfont \thechapter}
        \end{tabularx}
        \par\vskip2mm\hrule
    \fi
  }
}											            % ... her

\chapterstyle{jenor}						            % Valg af kapiteludseende - Google 'memoir chapter styles' for alternativer

% ¤¤ Sidehoved ¤¤ %

\makepagestyle{AAU}							            % Definerer sidehoved og sidefod udseende frem til ...
\makepsmarks{AAU}{
	\createmark{chapter}{left}{shownumber}{}{. \ }
	\createmark{section}{right}{shownumber}{}{. \ }
	\createplainmark{toc}{both}{\contentsname}
	\createplainmark{lof}{both}{\listfigurename}
	\createplainmark{lot}{both}{\listtablename}
	\createplainmark{bib}{both}{\bibname}
	\createplainmark{index}{both}{\indexname}
	\createplainmark{glossary}{both}{\glossaryname}
}
\nouppercaseheads										 	% Ingen Caps oenskes

\makeevenhead{AAU}{Mads, Lukas and Morten}{}{\leftmark}				% Definerer lige siders sidehoved (\makeevenhead{Navn}{Venstre}{Center}{Hoejre})
\makeoddhead{AAU}{\rightmark}{}{Copehagen Business School}		% Definerer ulige siders sidehoved (\makeoddhead{Navn}{Venstre}{Center}{Hoejre})
\makeevenfoot{AAU}{\thepage}{}{}							% Definerer lige siders sidefod (\makeevenfoot{Navn}{Venstre}{Center}{Hoejre})
\makeoddfoot{AAU}{}{}{Page \thepage \ of \pageref{LastPage}}							% Definerer ulige siders sidefod (\makeoddfoot{Navn}{Venstre}{Center}{Hoejre})
\makeheadrule{AAU}{\textwidth}{0.5pt}						% Tilfoejer en streg under sidehovedets indhold
\makefootrule{AAU}{\textwidth}{0.5pt}{1mm}					% Tilfoejer en streg under sidefodens indhold

\copypagestyle{AAUchap}{AAU}								% Sidehoved for kapitelsider defineres som standardsider, men med blank sidehoved
\makeoddhead{AAUchap}{}{}{}
\makeevenhead{AAUchap}{}{}{}
\makeheadrule{AAUchap}{\textwidth}{0pt}
\aliaspagestyle{chapter}{AAUchap}							% Den ny style vaelges til at gaelde for chapters
															% ... her
															
\pagestyle{AAU}												% Valg af sidehoved og sidefod

%%%% CUSTOM COMMANDS %%%%

% ¤¤ Billede hack ¤¤ %
\newcommand{\figur}[4]{
		\begin{figure}[H] \centering
			\includegraphics[width=#1\textwidth]{billeder/#2}
			\caption{#3}\label{#4}
		\end{figure} 
}

% ¤¤ Specielle tegn ¤¤ %
\newcommand{\decC}{^{\circ}\text{C}}
\newcommand{\dec}{^{\circ}}
\newcommand{\m}{\cdot}

%%%% ORDDELING %%%%

\hyphenation{}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Formatting for labelling appendixes %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\makeatletter
  \newcommand\incpdfchapter{%
    \ifartopt\par\@nameuse{chapterblock}\else
      \thispagestyle{chapter}
      \global\@topnum\z@
    \fi
    \m@mindentafterchapter
    \@ifstar{\@m@mschapter}{\@m@mchapter}}
\makeatother

